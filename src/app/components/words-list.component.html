<div class="words-list-container">
  <!-- Header -->
  <header class="header">
    <button class="back-button" (click)="goBack()" aria-label="Go back">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="m15 18-6-6 6-6"/>
      </svg>
    </button>
    <h1 class="title">Words Progress</h1>
  </header>

  <!-- Loading State -->
  <div *ngIf="isLoading && isInitializing" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading word progress...</p>
  </div>

  <!-- Content -->
  <div *ngIf="!isLoading || !isInitializing" class="content">
    <!-- Statistics Cards - Compact -->
    <div class="stats-compact">
      <div class="stat-compact-card" title="Total Words">
        <span class="stat-icon">ğŸ“–</span>
        <span class="stat-value">{{ statistics.totalWords }}</span>
      </div>
      <div class="stat-compact-card" title="New Words">
        <span class="stat-icon">ğŸ†•</span>
        <span class="stat-value">{{ statistics.newWords }}</span>
      </div>
      <div class="stat-compact-card" title="Learning Words">
        <span class="stat-icon">ğŸ“š</span>
        <span class="stat-value">{{ statistics.learningWords }}</span>
      </div>
      <div class="stat-compact-card" title="Mastered Words">
        <span class="stat-icon">ğŸ†</span>
        <span class="stat-value">{{ statistics.masteredWords }}</span>
      </div>
      <div class="stat-compact-card" title="Overall Accuracy">
        <span class="stat-icon">ğŸ¯</span>
        <span class="stat-value">{{ statistics.overallAccuracy }}%</span>
      </div>
      <div class="stat-compact-card" title="Total Practices">
        <span class="stat-icon">âš¡</span>
        <span class="stat-value">{{ statistics.totalPractices }}</span>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters-section">
      <div class="filters-header" (click)="toggleFilters()">
        <span class="filters-title">
          <svg class="filter-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 3H2l8 9.46V19l4 2v-8.54L22 3z"/>
          </svg>
          Filters & Search
        </span>
        <svg 
          class="expand-icon" 
          [class.expanded]="!isFiltersCollapsed"
          width="18" 
          height="18" 
          viewBox="0 0 24 24" 
          fill="none" 
          stroke="currentColor" 
          stroke-width="2"
        >
          <path d="M6 9l6 6 6-6"/>
        </svg>
      </div>

      <div class="filters-content" [class.collapsed]="isFiltersCollapsed">
        <div class="search-container">
          <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
          </svg>
          <input 
            type="text" 
            class="search-input"
            placeholder="Search words or translations..."
            [value]="filters.searchTerm"
            (input)="onSearchChange($any($event.target).value || '')"
          >
        </div>

        <div class="filter-row">
          <div class="filter-group">
            <label class="filter-label">Status:</label>
            <select 
              class="filter-select"
              [value]="filters.status"
              (change)="onStatusFilterChange($any($event.target).value)"
            >
              <option value="all">All Status</option>
              <option value="new">New</option>
              <option value="learning">Learning</option>
              <option value="mastered">Mastered</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="filter-label">Source:</label>
            <select 
              class="filter-select"
              [value]="filters.source"
              (change)="onSourceFilterChange($any($event.target).value)"
            >
              <option value="all">All Sources</option>
              <option value="dictionary">Dictionary</option>
              <option value="custom">Custom</option>
            </select>
          </div>

          <button class="clear-filters-btn" (click)="clearFilters()">
            Clear Filters
          </button>
        </div>
      </div>
    </div>

    <!-- Sort Controls - Compact -->
    <div class="sort-controls-compact">
      <div class="sort-group">
        <label class="sort-label">
          <svg class="sort-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 6h18M7 12h10m-7 6h4"/>
          </svg>
          Sort:
        </label>
        <select 
          class="sort-select"
          [value]="filters.sortBy"
          (change)="onSortChange($any($event.target).value)"
        >
          <option value="alphabetical">A-Z</option>
          <option value="lastStudied">Last Studied</option>
          <option value="practiceCount">Practice Count</option>
          <option value="accuracy">Accuracy</option>
          <option value="score">Quiz Score</option>
          <option value="dateAdded">Date Added</option>
        </select>
      </div>
      <button 
        class="sort-direction-btn"
        (click)="toggleSortDirection()"
        [title]="'Sort ' + (filters.sortDirection === 'asc' ? 'ascending' : 'descending')"
      >
        {{ filters.sortDirection === 'asc' ? 'â†‘' : 'â†“' }}
      </button>
    </div>
 
    <!-- Results Info -->
    <div class="results-info">
      <span>{{ filteredWords.length }} words found</span>
      <span *ngIf="filteredWords.length !== statistics.totalWords">
        (filtered from {{ statistics.totalWords }} total)
      </span>
    </div>

    <!-- Words List -->
    <div class="words-list">
      <div 
        *ngFor="let word of paginatedWords; trackBy: trackByWord"
        class="word-item"
      >
        <div class="word-header">
          <div class="word-info">
            <h3 class="word-german">{{ word.word }}</h3>
            <p class="word-translation">{{ word.translation }}</p>
          </div>
          <div class="word-meta">
            <div class="word-badges">
              <span [class]="getStatusBadgeClass(word.status)" class="badge-compact">
                {{ word.status === 'new' ? 'ğŸ†•' : word.status === 'learning' ? 'ğŸ“š' : 'ğŸ†' }}
              </span>
              <span [class]="getSourceBadgeClass(word.source)" class="badge-compact">
                {{ word.source === 'dictionary' ? 'ğŸ“–' : 'âœï¸' }}
              </span>
            </div>
            <button 
              class="reset-btn-compact"
              (click)="resetWordProgress(word)"
              title="Reset progress"
            >
              ğŸ”„
            </button>
          </div>
        </div>

        <div class="word-stats-compact">
          <span class="stat-compact" title="Total practices">
            ğŸ¯ {{ word.practiceCount }}
          </span>
          <span class="stat-compact" title="Correct answers">
            âœ… {{ word.correctCount }}
          </span>
          <span class="stat-compact" title="Wrong answers">
            âŒ {{ word.wrongCount }}
          </span>
          <span class="stat-compact" title="Accuracy percentage">
            ğŸ“Š {{ getAccuracy(word) }}%
          </span>
          <span class="stat-compact" title="Quiz score (last 3 attempts)">
            ğŸ² {{ getWordScore(word) }}/3
          </span>
          <span class="stat-compact" *ngIf="word.masteredDate" title="Mastered date">
            ğŸ† {{ formatDate(word.masteredDate) }}
          </span>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="filteredWords.length === 0 && !isLoading" class="empty-state">
        <div class="empty-icon">ğŸ“š</div>
        <h3>No words found</h3>
        <p>Try adjusting your filters or search term.</p>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="totalPages > 1" class="pagination">
      <button 
        class="pagination-button"
        [disabled]="currentPage === 1"
        (click)="changePage(currentPage - 1)"
      >
        Previous
      </button>

      <button 
        *ngFor="let page of pageNumbers"
        class="pagination-button"
        [class.active]="page === currentPage"
        (click)="changePage(page)"
      >
        {{ page }}
      </button>

      <button 
        class="pagination-button"
        [disabled]="currentPage === totalPages"
        (click)="changePage(currentPage + 1)"
      >
        Next
      </button>
    </div>
  </div>
</div>
